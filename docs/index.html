<!DOCTYPE html>
<html lang="EN">
  <head>
    <title>Source</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootswatch/4.5.2/cerulean/bootstrap.min.css" id="nsd-bootstrap-theme-stylesheet"/>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.min.js"></script>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Nasdanika-Models/html-app@master/gen/web-resources/css/app.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jstree@3.3.16/dist/themes/default/style.min.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@5.5.0/github-markdown.min.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/styles/default.min.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-vue@2.23.0/dist/bootstrap-vue.css"/>
    <script src="https://cdn.jsdelivr.net/gh/Nasdanika-Models/html-app@master/gen/web-resources/js/common.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/Nasdanika-Models/html-app@master/gen/web-resources/js/dark-head.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jstree@3.3.16/dist/jstree.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/highlight.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.7.16/dist/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-vue@2.23.0/dist/bootstrap-vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/Nasdanika-Models/html-app@master/gen/web-resources/js/components/table.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/Nasdanika-Models/ecore@master/graph/web-resources/components/table.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.3/echarts.min.js"></script><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-9BRJVLK8CC"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9BRJVLK8CC');
</script>    
</head>
  <body>
    <div class="container-fluid nsd-app-container">
      <div class="row">
        <div class="col nsd-app-header">
          <a href="https://github.com/Nasdanika-Models" data-nsd-label-uuid="fd53ce28-194c-4a13-a244-4bc2d559ea10" class="nsd-app-header-title">
            <img src="https://docs.nasdanika.org/images/nasdanika-logo.png" class="nsd-app-label-icon"/>Nasdanika Models</a>
          <ul class="nav nsd-app-header-navs">
            <li class="nav-item">
              <a href="search.html" data-nsd-label-uuid="77d799d2-8bfb-4bad-8689-b06eb4cc1f08" class="nav-link"><span class="fas fa-search nsd-app-label-icon"></span>Search</a>
            </li>
            <li class="nav-item">
              <a href="glossary.html" data-nsd-label-uuid="f81929c9-effe-4cd9-94c7-938f426a9f9b" class="nav-link"><span class="fas fa-book nsd-app-label-icon"></span>Glossary</a>
            </li>
          </ul>
        </div>
      </div>
      <div class="row">
        <div class="col nsd-app-navbar">
          <ul class="navbar navbar-light navbar-expand-lg"><span title="Source model for analysis and code generation" data-nsd-label-uuid="9344d619-8448-4507-a4e0-52a76514cb44" class="navbar-brand"><img src="https://img.icons8.com/color/48/document--v1.png" class="nsd-app-label-icon"/>Source</span>
            <button type="button" data-toggle="collapse" data-target="#nsd_cp" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler"><span class="navbar-toggler-icon"></span>
            </button>
            <div id="nsd_cp" class="collapse navbar-collapse">
              <ul class="navbar-nav mr-auto">
                <li class="nav-item">
                  <a href="classifiers.html" data-nsd-label-uuid="125e35f6-644b-4ad7-9117-6c30640fbac7" class="nav-link">Classifiers</a>
                </li>
                <li class="nav-item">
                  <a href="diagram.html" data-nsd-label-uuid="95fd5e3d-9b04-455b-b870-7bc4d02c99c8" class="nav-link"><span class="fas fa-project-diagram nsd-app-label-icon"></span>Diagram</a>
                </li>
                <li class="nav-item">
                  <li data-nsd-label-uuid="8c7da237-14bc-4d6c-889a-396dd92ddd96" class="dropdown">
                    <a role="button" data-toggle="dropdown" class="nav-link dropdown-toggle">
                      <img src="https://img.icons8.com/external-dreamstale-lineal-dreamstale/16/external-diagram-seo-media-dreamstale-lineal-dreamstale.png" class="nsd-app-label-icon"/>Graphs</a>
                    <div class="dropdown-menu">
                      <a href="default-graph.html" data-nsd-label-uuid="e9efced9-7c51-4f89-b35e-451834564e9c" class="dropdown-item">Default Graph</a>
                      <a href="circular-layout-graph.html" data-nsd-label-uuid="9dafda4b-332a-4feb-a624-efd50904c7ab" class="dropdown-item">Circular Graph</a>
                      <a href="force-layout-graph.html" data-nsd-label-uuid="4983bc0b-9078-4f10-865f-7d1173f222ae" class="dropdown-item">Force Graph</a>
                      <a href="force-layout-graph-3d.html" data-nsd-label-uuid="804a15ad-3164-462f-aa8c-03d9bf09a532" class="dropdown-item">Force Graph 3D</a>
                      <div title="With dependencies and sub-packages" class="dropdown-divider"></div>
                      <a href="default-graph-with-dependencies-and-subpackages.html" data-nsd-label-uuid="05c46e7c-a687-4aad-8a6c-56b380c76e38" class="dropdown-item">Default Graph</a>
                      <a href="circular-layout-graph-with-dependencies-and-subpackages.html" data-nsd-label-uuid="5dd99b9e-2ad5-4d93-93f0-b17dd72a7486" class="dropdown-item">Circular Graph</a>
                      <a href="force-layout-graph-with-dependencies-and-subpackages.html" data-nsd-label-uuid="a8f1b17c-704e-4789-a4fb-be6e6ba8f865" class="dropdown-item">Force Graph</a>
                      <a href="force-layout-graph-3d-with-dependencies-and-subpackages.html" data-nsd-label-uuid="91b79d83-53cf-457f-af66-a3d9e02a5066" class="dropdown-item">Force Graph 3D</a>
                    </div>
                  </li>
                </li>
              </ul>
            </div>
          </ul>
        </div>
      </div>
      <div class="row nsd-app-content-row">
        <div class="col nsd-app-navigation-panel">
          <div class="list-group list-group-flush">
            <a href="references/eClassifiers/Comparable/index.html" data-nsd-label-uuid="097704e9-7179-4d46-bc15-a0c2c1c29d65" class="list-group-item list-group-action">
              <img src="https://cdn.jsdelivr.net/gh/Nasdanika-Models/ecore@master/graph/web-resources/icons/EInterface.gif" class="nsd-app-label-icon"/><i>Comparable</i></a>
            <a href="references/eClassifiers/GenerationMode/index.html" data-nsd-label-uuid="4387d3c5-943f-4077-b14b-7b77cea4fc53" class="list-group-item list-group-action">
              <img src="https://cdn.jsdelivr.net/gh/Nasdanika-Models/ecore@master/graph/web-resources/icons/EEnum.gif" class="nsd-app-label-icon"/>GenerationMode</a>
            <a href="references/eClassifiers/NamedElement/index.html" data-nsd-label-uuid="f1d390ff-7897-4054-bcc3-eab88b9b029d" class="list-group-item list-group-action">
              <img src="https://cdn.jsdelivr.net/gh/Nasdanika-Models/ecore@master/graph/web-resources/icons/EClass.gif" class="nsd-app-label-icon"/>NamedElement</a>
            <a href="references/eClassifiers/Position/index.html" data-nsd-label-uuid="d4a3547c-e796-434a-acb4-74f5e264a13e" class="list-group-item list-group-action">
              <img src="https://cdn.jsdelivr.net/gh/Nasdanika-Models/ecore@master/graph/web-resources/icons/EClass.gif" class="nsd-app-label-icon"/>Position</a>
            <a href="references/eClassifiers/Range/index.html" data-nsd-label-uuid="8f257504-bdb3-4301-b83b-540954d1c00f" class="list-group-item list-group-action">
              <img src="https://cdn.jsdelivr.net/gh/Nasdanika-Models/ecore@master/graph/web-resources/icons/EClass.gif" class="nsd-app-label-icon"/>Range</a>
            <a href="references/eClassifiers/Source/index.html" data-nsd-label-uuid="7f8291ee-7737-4fc6-8607-ddfc6970d1f2" class="list-group-item list-group-action">
              <img src="https://cdn.jsdelivr.net/gh/Nasdanika-Models/ecore@master/graph/web-resources/icons/EClass.gif" class="nsd-app-label-icon"/>Source</a>
            <a href="references/eClassifiers/TokenSource/index.html" data-nsd-label-uuid="0fa605d2-911f-45d5-b413-bb864ef132e9" class="list-group-item list-group-action">
              <img src="https://cdn.jsdelivr.net/gh/Nasdanika-Models/ecore@master/graph/web-resources/icons/EInterface.gif" class="nsd-app-label-icon"/><i>TokenSource</i></a>
          </div>
        </div>
        <div data-nsd-label-uuid="9344d619-8448-4507-a4e0-52a76514cb44" data-nsd-action-uris="uuid:9344d619-8448-4507-a4e0-52a76514cb44" class="col nsd-app-content-panel">
          <div class="container-fluid">
            <div class="row nsd-app-content-panel-content-row">
              <div class="col">
                <div class="container-fluid">
                  <div class="row">
                    <div class="col"><p>Nasdanika Java model can be used for analysis and code generation. It can be loaded from source files, class files and jar files. Model elements can reference <a href="https://coverage.models.nasdanika.org/">coverage</a> results.</p>
<p>Model elements can be referenced from other models. For example, <a href="https://maven.models.nasdanika.org/">Maven</a> project may reference a <a href="references/eClassifiers/Module/index.html">Java Module</a>.</p>
<p>File/resource top-level model elements, such as compilation units for <code>*.java</code> files and types for <code>*.class</code> files, are loaded as <a href="https://javadoc.io/static/org.eclipse.emf/org.eclipse.emf.ecore/2.33.0/org/eclipse/emf/ecore/resource/Resource.html">resources</a>. It allows to use custom <a href="https://javadoc.io/static/org.eclipse.emf/org.eclipse.emf.ecore/2.33.0/org/eclipse/emf/ecore/resource/URIHandler.html">URI handlers</a> to load resources from different sources. For example, <a href="https://javadoc.io/static/org.nasdanika.models.gitlab/model/2024.3.0/org.nasdanika.models.gitlab/org/nasdanika/models/gitlab/util/GitLabURIHandler.html">GitLabURIHandler</a> can be used to load sources from GitLab repositories using REST API, without cloning, and commit modifications to GitLab. Logical URI&rsquo;s, e.g. <code>java://classes/org/nasdanika/common/Util</code> may be used to reference model elements. Such logical URI&rsquo;s would be resolved to physical URI&rsquo;s, which may be different in different contexts - java sources or class files.</p>
<p>Java model elements may be extended (subclassed) and subclasses can be loaded instead of the base classes. In the above example of a Maven project referencing a Java module, instead of a reference there might be a class, say <code>MavenJar</code>, extending both Maven project and Java module. Another example might be a <code>JavaTextRepositoryFile</code> extending both <a href="https://gitlab.models.nasdanika.org/index.html">GitLab</a> <a href="https://gitlab.models.nasdanika.org/references/eClassifiers/TextRepositoryFile/index.html">TextRepositoryFile</a> and <a href="https://java.models.nasdanika.org/references/eClassifiers/CompilationUnit/index.html">CompilationUnit</a>.</p>
<p>Yet another example, which might be combined with the above examples, is a class extending Maven project, Java module, and <a href="https://architecture.models.nasdanika.org/references/eClassifiers/ArchitectureElement/index.html">Architecture element</a></p>
<p>This model is coarse-grained - it provides classes representing high-level &ldquo;externally referenceable&rdquo; constructs of the <a href="https://docs.oracle.com/javase/specs/jls/se22/html/index.html">Java language</a>. Low-level constructs such as statements and expressions are not modeled.</p>
<p>Also, the model is somewhat loose on purpose to simplify code generation. For example, a <a href="references/eClassifiers/Source/index.html">source</a> child can be added to any subclass of Source and source can be set to any text.</p>
<p>The below diagram shows key model classes and their relationships. Some intermediate classes are omitted in the inheritance hierarchy. See the <a href="diagram.html">full diagram</a> for additional details.</p>
<div class="nsd-error">
Error loading resource java.drawio: java.lang.NullPointerException: ClassLoader resource not found: org/nasdanika/models/source/processors/ecore/java.drawio
</div>
<h2><a href="#maven-dependency" id="maven-dependency">Maven dependency</a></h2>
<p><a href="https://central.sonatype.com/artifact/org.nasdanika.models.java/model">Maven Central Entry</a></p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.nasdanika.models.java&lt;/groupId&gt;
    &lt;artifactId&gt;model&lt;/artifactId&gt;
    &lt;version&gt;latest version from Maven Central&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>
<h2><a href="#javadoc" id="javadoc">Javadoc</a></h2>
<p><a href="https://javadoc.io/doc/org.nasdanika.models.java/model/latest/org.nasdanika.models.java/module-summary.html">Latest</a></p>
<h2><a href="#loading" id="loading">Loading</a></h2>
<h3><a href="#from-sources" id="from-sources">From sources</a></h3>
<h4><a href="#individual-sources" id="individual-sources">Individual sources</a></h4>
<pre><code class="language-java">ResourceSet resourceSet = new ResourceSetImpl();
resourceSet.getResourceFactoryRegistry().getExtensionToFactoryMap().put(&quot;java&quot;, new JavaParserResourceFactory());		
		
String javaPackagePath = new File(&quot;src/main/java/org/nasdanika/models/java/JavaPackage.java&quot;).getCanonicalPath();
Resource javaPackageResource = resourceSet.getResource(URI.createFileURI(javaPackagePath), true);
</code></pre>
<h4><a href="#directory" id="directory">Directory</a></h4>
<pre><code class="language-java">public void loadSourceDirectory() throws IOException {
	ResourceSet resourceSet = new ResourceSetImpl();
	resourceSet.getResourceFactoryRegistry().getExtensionToFactoryMap().put(&quot;java&quot;, new JavaParserResourceFactory());		

	// For loading directory contents
	resourceSet.getResourceFactoryRegistry().getExtensionToFactoryMap().put(Resource.Factory.Registry.DEFAULT_EXTENSION, new XMIResourceFactoryImpl());		
	URIHandler fileDirectoryURIHandler = new DirectoryContentFileURIHandler();
	resourceSet.getURIConverter().getURIHandlers().add(0, fileDirectoryURIHandler);
	
	
	String javaSourcesPath = new File(&quot;src/main/java&quot;).getCanonicalPath();
	Resource javaSourcesResource = resourceSet.getResource(URI.createFileURI(javaSourcesPath), true);
	for (EObject root: javaSourcesResource.getContents()) {
		visit(root);
	}		
}

private void visit(EObject eObject) {
	System.out.println(eObject);
	if (eObject instanceof TreeItem) {
		System.out.println(((TreeItem) eObject).getName());
	}
	if (eObject instanceof Tree) {
		for (TreeItem treeItem: ((Tree) eObject).getTreeItems()) {
			URI itemURI = URI.createURI(treeItem.getName()).resolve(eObject.eResource().getURI().appendSegment(&quot;&quot;));
			Resource itemResource = eObject.eResource().getResourceSet().getResource(itemURI, true);
			for (EObject root: itemResource.getContents()) {
				visit(root);
			}		
		}
	}		
}

</code></pre>
<h4><a href="#with-coverage" id="with-coverage">With coverage</a></h4>
<pre><code class="language-java">File projectDir = new File(&quot;&lt;path to a Maven project directory&quot;);
File jacocoExec = new File(projectDir, &quot;target/jacoco.exec&quot;);
ResourceSet resourceSet = new ResourceSetImpl();		
resourceSet.getResourceFactoryRegistry().getExtensionToFactoryMap().put(Resource.Factory.Registry.DEFAULT_EXTENSION, new XMIResourceFactoryImpl());
ModuleCoverage moduleCoverage = ModuleCoverage.loadJacoco(&quot;&lt;module name&gt;&quot;, jacocoExec, new File(projectDir, &quot;target/classes&quot;));
		
resourceSet
	.getResourceFactoryRegistry()
	.getExtensionToFactoryMap()
	.put(
		&quot;java&quot;, 
		new JavaParserResourceFactory(new ModuleCoverageProvider(moduleCoverage)));		

...
</code></pre>
<h3><a href="#from-class-files" id="from-class-files">From class files</a></h3>
<p>TODO</p>
<h3><a href="#from-jar-files" id="from-jar-files">From jar files</a></h3>
<p>TODO</p>
<h2><a href="#generation" id="generation">Generation</a></h2>
<h3><a href="#source" id="source">Source</a></h3>
<p>Low-level example - TODO - test case</p>
<h3><a href="#compilation-unit" id="compilation-unit">Compilation Unit</a></h3>
<h2><a href="#use-cases" id="use-cases">Use Cases</a></h2>
<h3><a href="#analysis-and-documentationcode-generation" id="analysis-and-documentationcode-generation">Analysis and documentation/code generation</a></h3>
<p><a href="https://rules.models.nasdanika.org/">Nasdanika Rules</a> has a demo of inspecting Java sources and then generating test classes using OpenAI chat completions. Sources are retrieved from GitLab and generated test classes are committed to GitLab.</p>
<p>The Java model combines both source and bytecode information, such as calls method makes, fields it accesses, or callers of a method. This information may be used to generate documentation and visualizations such as UML diagrams. It can also be used as part of GenAI prompts to generate documentation, recommendations, or test code. In the later case coverage information can be used to generate tests for classes and methods with low coverage.</p>
<p>Some insights which might be provided by Java analysis:</p>
<ul>
<li>Module - removal of direct dependencies if there is a transient dependency. Say C depends on A and B, B has A as a transitive dependency. There is no need for C to have a direct dependency on A - it doesn&rsquo;t hurt, though.</li>
<li>Circular dependencies between packages. Sometimes such dependencies are inevitable, so this &ldquo;rule&rdquo; shall be parameterizable. E.g. exclude child packages, or have an annotation to indicate that a circular dependency is by design, similar to <code>SuppressWarning</code> annotation.</li>
</ul>
<h3><a href="#code-generation" id="code-generation">Code generation</a></h3>
<p><a href="https://function-flow.models.nasdanika.org/">Nasdanika Function Flow</a> leverages the Java model to generate code for Java source activities. GenAI is used to generate code from high level descriptions (specification) and contextual information.</p>
</div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col nsd-app-footer">
          <ul class="nav nsd-app-footer-navs">
            <li class="nav-item">
              <a href="https://github.com/Nasdanika-Models/source-engineering" data-nsd-label-uuid="80874e67-316f-4e74-854f-8c5d77359a3c" class="nav-link"><span class="fab fa-github nsd-app-label-icon"></span>Sources</a>
            </li>
            <li class="nav-item"><span class="navbar-text">&nbsp;&bull;&nbsp;</span>
            </li>
            <li class="nav-item">
              <a href="https://icons8.com/" title="Icons from ICONS8" class="nav-link">
                <img src="https://img.icons8.com/fluency/16/icons8-new-logo.png" class="nsd-app-label-icon"/>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </body>
</html>